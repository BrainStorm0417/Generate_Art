var Pts=function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(i,'a',i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=10)}([function(e,t,i){'use strict';function n(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}var o=Math.max,a=Math.min;Object.defineProperty(t,'__esModule',{value:!0});const r=i(1),s=i(4),l=i(3);t.PtBaseArray=Float32Array;class c extends t.PtBaseArray{constructor(...e){super(0<e.length?r.Util.getArgs(e):[0,0])}static make(e,i=0){let n=new t.PtBaseArray(e);return i&&n.fill(i),new c(n)}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(e){this[0]=e}set y(e){this[1]=e}set z(e){this[2]=e}set w(e){this[3]=e}clone(){return new c(this)}equals(e,t=1e-6){for(let n=0,i=this.length;n<i;n++)if(Math.abs(this[n]-e[n])>t)return!1;return!0}to(...e){let t=r.Util.getArgs(e);for(let n=0,i=a(this.length,t.length);n<i;n++)this[n]=t[n];return this}toAngle(e,t){let i=t==void 0?this.magnitude():t;return this.to(Math.cos(e)*i,Math.sin(e)*i)}op(e){let t=this;return(...i)=>{return e(t,...i)}}ops(e){let t=[];for(let n=0,i=e.length;n<i;n++)t.push(this.op(e[n]));return t}$map(e){let t=this.clone();return l.Vec.map(t,e),t}$take(e){let t=[];for(let n=0,i=e.length;n<i;n++)t.push(this[e[n]]||0);return new c(t)}$slice(e,i){let n=new t.PtBaseArray(this).slice(e,i);return new c(n)}$concat(...e){return new c(this.toArray().concat(r.Util.getArgs(e)))}add(...e){return 1===e.length&&'number'==typeof e[0]?l.Vec.add(this,e[0]):l.Vec.add(this,r.Util.getArgs(e)),this}$add(...e){return this.clone().add(...e)}subtract(...e){return 1===e.length&&'number'==typeof e[0]?l.Vec.subtract(this,e[0]):l.Vec.subtract(this,r.Util.getArgs(e)),this}$subtract(...e){return this.clone().subtract(...e)}multiply(...e){return 1===e.length&&'number'==typeof e[0]?l.Vec.multiply(this,e[0]):l.Vec.multiply(this,r.Util.getArgs(e)),this}$multiply(...e){return this.clone().multiply(...e)}divide(...e){return 1===e.length&&'number'==typeof e[0]?l.Vec.divide(this,e[0]):l.Vec.divide(this,r.Util.getArgs(e)),this}$divide(...e){return this.clone().divide(...e)}magnitudeSq(){return l.Vec.dot(this,this)}magnitude(){return l.Vec.magnitude(this)}unit(e=void 0){return l.Vec.unit(this,e),this}$unit(e=void 0){return this.clone().unit(e)}dot(...e){return l.Vec.dot(this,r.Util.getArgs(e))}$cross(...e){return l.Vec.cross(this,r.Util.getArgs(e))}$project(e){let t=e.magnitude(),i=this.$unit(),n=e.$divide(t),o=i.dot(n);return i.multiply(t*o)}abs(){return l.Vec.abs(this),this}$abs(){return this.clone().abs()}floor(){return l.Vec.floor(this),this}$floor(){return this.clone().floor()}ceil(){return l.Vec.ceil(this),this}$ceil(){return this.clone().ceil()}round(){return l.Vec.round(this),this}$round(){return this.clone().round()}$min(e){let t=this.clone();for(let n=0,i=a(this.length,e.length);n<i;n++)t[n]=a(this[n],e[n]);return t}$max(e){let t=this.clone();for(let n=0,i=a(this.length,e.length);n<i;n++)t[n]=o(this[n],e[n]);return t}angle(e=r.Const.xy){return Math.atan2(this[e[1]],this[e[0]])}angleBetween(e,t=r.Const.xy){return s.Geom.boundRadian(this.angle(t))-s.Geom.boundRadian(e.angle(t))}scale(e,t){return s.Geom.scale(this,e,t||c.make(this.length,0)),this}rotate2D(e,t,i){return s.Geom.rotate2D(this,e,t||c.make(this.length,0),i),this}shear2D(e,t,i){return s.Geom.shear2D(this,e,t||c.make(this.length,0),i),this}reflect2D(e,t){return s.Geom.reflect2D(this,e,t),this}isPerpendicular(e){return 0==this.dot(e)}toString(){return`Pt(${this.join(',')})`}toArray(){return[].slice.call(this)}static combine(e,t,n){let o=new d;for(let a=0,i=e.length;a<i;a++)for(let i=0,r=t.length;i<r;i++)o.push(n(e[a],t[i]));return o}}t.Pt=c;class d extends n(Array){constructor(...e){super(...e)}clone(){let e=new d;for(let t=0,i=this.length;t<i;t++)e.push(this[t].clone());return e}static fromArray(e){let t=new d;for(let n,o=0,i=e.length;o<i;o++)n=e[o]instanceof c?e[o]:new c(e[o]),t.push(n);return t}static fromGroup(e){return d.from(e)}split(e,t){let i=r.Util.split(this,e,t);return i.map((e)=>d.fromGroup(e))}insert(e,t=0){d.prototype.splice.apply(this,[t,0,...e]);return this}remove(e=0,t=1){let i=0>e?[-1*e-1,t]:[e,t];return d.prototype.splice.apply(this,i)}segments(e=2,t=2){return this.split(2,t)}lines(){return this.segments(2,1)}op(e){let t=this;return(...i)=>{return e(t,...i)}}ops(e){let t=[];for(let n=0,i=e.length;n<i;n++)t.push(this.op(e[n]));return t}boundingBox(){return s.Geom.boundingBox(this)}centroid(){return s.Geom.centroid(this)}interpolate(e){let t=this.length-1,i=1/(this.length-1),n=Math.floor(e/i);return s.Geom.interpolate(this[n],this[n+1],(e-n*i)*t)}moveBy(...e){let t=r.Util.getArgs(e);for(let n=0,i=this.length;n<i;n++)this[n].add(t);return this}moveTo(...e){let t=new c(r.Util.getArgs(e)).subtract(this[0]);return this.moveBy(t),this}scale(e,t){for(let n=0,i=this.length;n<i;n++)s.Geom.scale(this[n],e,t||this[0]);return this}rotate2D(e,t,n){for(let o=0,i=this.length;o<i;o++)s.Geom.rotate2D(this[o],e,t||this[0],n);return this}shear2D(e,t,n){for(let o=0,i=this.length;o<i;o++)s.Geom.shear2D(this[o],e,t||this[0],n);return this}reflect2D(e,t){for(let n=0,i=this.length;n<i;n++)s.Geom.reflect2D(this[n],e,t);return this}sortByDimension(e,t=!1){return this.sort((i,n)=>t?n[e]-i[e]:i[e]-n[e])}toString(){return'Group[ '+this.reduce((e,t)=>e+t.toString()+' ','')+' ]'}zipOne(e,t=!1){let i='boolean'==typeof t?'get':'at',n=[];for(let o=0,i=this.length;o<i;o++){if(this[o].length-1<e&&!1===t)throw`Index ${e} is out of bounds`;n.push(this[o][e]||t)}return new c(n)}zip(e=!1,t=!1){let n=new d,a=t?this.reduce((e,t)=>o(e,t.length),0):this[0].length;for(let o=0;o<a;o++)n.push(this.zipOne(o,e));return n}static combine(e,t,n){let o=[];for(let a=0,i=e.length;a<i;a++)for(let i=0,r=t.length;i<r;i++)o.push(n(e[a],t[i]));return o}}t.Group=d},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const n=i(0);t.Const={xy:'xy',yz:'yz',xz:'xz',xyz:'xyz',horizontal:0,vertical:1,identical:0,right:4,bottom_right:5,bottom:6,bottom_left:7,left:8,top_left:1,top:2,top_right:3,epsilon:1e-4,pi:Math.PI,two_pi:6.283185307179586,half_pi:1.5707963267948966,quarter_pi:0.7853981633974483,one_degree:0.017453292519943295,rad_to_deg:57.29577951308232,deg_to_rad:0.017453292519943295,gravity:9.81,newton:0.10197,gaussian:0.3989422804014327};t.Util=class{static getArgs(e){if(1>e.length)return[];var t=[],i=Array.isArray(e[0])||ArrayBuffer.isView(e[0]);if('number'==typeof e[0])t=Array.prototype.slice.call(e);else if('object'==typeof e[0]&&!i){let n=['x','y','z','w'],o=e[0];for(let e=0;e<n.length&&!(o.length&&e>=o.length||!(n[e]in o));e++)t.push(o[n[e]])}else i&&(t=[].slice.call(e[0]));return t}static split(e,t,i){let n=i||t,o=[];for(let a=0;a<e.length&&!(a*n+t>e.length);a++)o.push(e.slice(a*n,a*n+t));return o}static flatten(e,t=!0){let i=t?new n.Group:[];return i.concat.apply(i,e)}static equals(e,t,i=1e-5){return Math.abs(e-t)<i}}},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const n=i(0);class o{constructor(e,t){if(this._center=new n.Pt,this._size=new n.Pt,this._topLeft=new n.Pt,this._bottomRight=new n.Pt,this._inited=!1,e&&(this._size=new n.Pt(e),this._inited=!0),e&&t){let i=new n.Pt(e),o=new n.Pt(t);this._topLeft=i.$min(o),this._bottomRight=i.$max(o),this._updateSize()}}clone(){return new o(this._topLeft,this._bottomRight)}_updateSize(){this._size=this._bottomRight.$subtract(this._topLeft).abs(),this._updateCenter()}_updateCenter(){this._center=this._size.$multiply(0.5).add(this._topLeft)}_updatePosFromTop(){this._bottomRight=this._topLeft.$add(this._size),this._updateCenter()}_updatePosFromBottom(){this._topLeft=this._bottomRight.$subtract(this._size),this._updateCenter()}_updatePosFromCenter(){let e=this._size.$multiply(0.5);this._topLeft=this._center.$subtract(e),this._bottomRight=this._center.$add(e)}get size(){return new n.Pt(this._size)}set size(e){this._size=new n.Pt(e),this._updatePosFromTop()}get center(){return new n.Pt(this._center)}set center(e){this._center=new n.Pt(e),this._updatePosFromCenter()}get topLeft(){return new n.Pt(this._topLeft)}set topLeft(e){this._topLeft=new n.Pt(e),this._updateSize()}get bottomRight(){return new n.Pt(this._bottomRight)}set bottomRight(e){this._bottomRight=new n.Pt(e),this._updateSize()}get width(){return 0<this._size.length?this._size.x:0}set width(e){this._size.x=e,this._updatePosFromTop()}get height(){return 1<this._size.length?this._size.y:0}set height(e){this._size.y=e,this._updatePosFromTop()}get depth(){return 2<this._size.length?this._size.z:0}set depth(e){this._size.z=e,this._updatePosFromTop()}get x(){return this.topLeft.x}get y(){return this.topLeft.y}get z(){return this.topLeft.z}get inited(){return this._inited}static fromBoundingRect(e){let t=new o(new n.Pt(e.left||0,e.top||0),new n.Pt(e.right||0,e.bottom||0));return e.width&&e.height&&(t.size=new n.Pt(e.width,e.height)),t}}t.Bound=o},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const n=i(0),o=i(4);class r{static add(e,t){if('number'==typeof t)for(let n=0,i=e.length;n<i;n++)e[n]+=t;else for(let n=0,i=e.length;n<i;n++)e[n]+=t[n]||0;return e}static subtract(e,t){if('number'==typeof t)for(let n=0,i=e.length;n<i;n++)e[n]-=t;else for(let n=0,i=e.length;n<i;n++)e[n]-=t[n]||0;return e}static multiply(e,t){if('number'==typeof t)for(let n=0,i=e.length;n<i;n++)e[n]*=t;else for(let n=0,i=e.length;n<i;n++)e[n]*=t[n]||1;return e}static divide(e,t){if('number'==typeof t)for(let n=0,i=e.length;n<i;n++)e[n]/=t;else for(let n=0,i=e.length;n<i;n++)e[n]/=t[n]||1;return e}static dot(e,t){if(e.length!=t.length)throw'Array lengths don\'t match';let n=0;for(let o=0,i=e.length;o<i;o++)n+=e[o]*t[o];return n}static cross(e,t){return new n.Pt(e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0])}static magnitude(e){return Math.sqrt(r.dot(e,e))}static unit(e,t=void 0){let i=t===void 0?r.magnitude(e):t;return r.divide(e,i)}static abs(e){return r.map(e,Math.abs)}static floor(e){return r.map(e,Math.floor)}static ceil(e){return r.map(e,Math.ceil)}static round(e){return r.map(e,Math.round)}static max(e){let t=Number.MIN_VALUE,n=0;for(let o=0,i=e.length;o<i;o++)t=Math.max(t,e[o]),t===e[o]&&(n=o);return{value:t,index:n}}static min(e){let t=Number.MAX_VALUE,n=0;for(let o=0,i=e.length;o<i;o++)t=Math.min(t,e[o]),t===e[o]&&(n=o);return{value:t,index:n}}static sum(e){let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n];return t}static map(e,t){for(let n=0,i=e.length;n<i;n++)e[n]=t(e[n],n,e);return e}}t.Vec=r;class a{static transform2D(e,t){let i=e[0]*t[0][0]+e[1]*t[1][0]+t[2][0],o=e[0]*t[0][1]+e[1]*t[1][1]+t[2][1];return new n.Pt(i,o)}static scale2DMatrix(e,t){return new n.Group(new n.Pt(e,0,0),new n.Pt(0,t,0),new n.Pt(0,0,1))}static rotate2DMatrix(e,t){return new n.Group(new n.Pt(e,t,0),new n.Pt(-t,e,0),new n.Pt(0,0,1))}static shear2DMatrix(e,t){return new n.Group(new n.Pt(1,e,0),new n.Pt(t,1,0),new n.Pt(0,0,1))}static translate2DMatrix(e,t){return new n.Group(new n.Pt(1,0,0),new n.Pt(0,1,0),new n.Pt(e,t,1))}static scaleAt2DMatrix(e,t,i){let n=a.scale2DMatrix(e,t);return n[2][0]=-i[0]*e+i[0],n[2][1]=-i[1]*t+i[1],n}static rotateAt2DMatrix(e,t,i){let n=a.rotate2DMatrix(e,t);return n[2][0]=i[0]*(1-e)+i[1]*t,n[2][1]=i[1]*(1-e)-i[0]*t,n}static shearAt2DMatrix(e,t,i){let n=a.shear2DMatrix(e,t);return n[2][0]=-i[1]*t,n[2][1]=-i[0]*e,n}static reflectAt2DMatrix(e,t){let i=o.Line.intercept(e,t);if(i==void 0)return[new n.Pt([-1,0,0]),new n.Pt([0,1,0]),new n.Pt([e[0]+t[0],0,1])];let a=i.yi,r=2*Math.atan(i.slope),s=Math.cos(r),l=Math.sin(r);return[new n.Pt([s,l,0]),new n.Pt([l,-s,0]),new n.Pt([-a*l,a+a*s,1])]}}t.Mat=a},function(e,t,i){'use strict';var n=Math.PI,o=Math.floor,r=Math.max,a=Math.sin,s=Math.cos,l=Math.min;Object.defineProperty(t,'__esModule',{value:!0});const d=i(1),u=i(0),c=i(3);class _{static lerp(e,i,n){return(1-n)*e+n*i}static boundValue(e,t,i,n=!1){let o=Math.abs(i-t),r=e%o;return r>i?r-=o:r<t&&(r+=o),r}static within(e,t,i){return e>=l(t,i)&&e<=r(t,i)}static randomRange(e,t=0){let i=e>t?e-t:t-e;return e+Math.random()*i}static normalizeValue(e,t,i){let n=l(t,i),o=r(t,i);return(e-n)/(o-n)}static sum(e){let t=u.Pt.make(e[0].length,0);for(let n=0,i=e.length;n<i;n++)t.add(e[n]);return t}static average(e){return _.sum(e).divide(e.length)}static mapToRange(e,t,i,n,o){if(t==i)throw'[currMin, currMax] must define a range that is not zero';let a=l(n,o),s=r(n,o);return _.normalizeValue(e,t,i)*(s-a)+a}}t.Num=_;class p{static boundAngle(e){return _.boundValue(e,0,360)}static boundRadian(e){return _.boundValue(e,0,d.Const.two_pi)}static toRadian(e){return e*d.Const.deg_to_rad}static toDegree(e){return e*d.Const.rad_to_deg}static boundingBox(e){let t=u.Pt.make(e[0].length,Number.MAX_VALUE),n=u.Pt.make(e[0].length,Number.MIN_VALUE);for(let o=0,i=e.length;o<i;o++)for(let i=0,a=e[o].length;i<a;i++)e[o][i]<t[i]&&(t[i]=e[o][i]),e[o][i]>n[i]&&(n[i]=e[o][i]);return new u.Group(t,n)}static centroid(e){return _.average(e)}static interpolate(e,n,o=0.5){let t=l(e.length,n.length),a=u.Pt.make(t);for(let r=0;r<t;r++)a[r]=e[r]*(1-o)+n[r]*o;return a}static perpendicular(e,t=d.Const.xy){let i=t[1],n=t[0],o=new u.Pt(e),a=new u.Pt(o);a[n]=-o[i],a[i]=o[n];let r=new u.Pt(o);return r[n]=o[i],r[i]=-o[n],new u.Group(a,r)}static isPerpendicular(e,t){return 0===new u.Pt(e).dot(t)}static withinBound(e,t,n){for(let o=0,i=l(e.length,t.length,n.length);o<i;o++)if(!(e[o]>=l(t[o],n[o])&&e[o]<=r(t[o],n[o])))return!1;return!0}static scale(e,t,i){let n=Array.isArray(e)?e:[e],o='number'==typeof t?u.Pt.make(n[0].length,t):t;i||(i=u.Pt.make(n[0].length,0));for(let a,r=0,s=n.length;r<s;r++){a=n[r];for(let e=0,t=a.length;e<t;e++)a[e]=i&&i[e]?i[e]+(a[e]-i[e])*o[e]:a[e]*o[e]}return p}static rotate2D(e,t,n,o){let r=Array.isArray(e)?e:[e],l=n==void 0?c.Mat.rotate2DMatrix:c.Mat.rotateAt2DMatrix;n||(n=u.Pt.make(r[0].length,0));let d=s(t),_=a(t);for(let a,s=0,i=r.length;s<i;s++)a=void 0==o?r[s]:r[s].$take(o),a.to(c.Mat.transform2D(a,l(d,_,n)));return p}static shear2D(e,t,n,o){var i=Math.tan;let a=Array.isArray(e)?e:[e],r='number'==typeof t?[t,t]:t;n||(n=u.Pt.make(a[0].length,0));let s=n==void 0?c.Mat.shear2DMatrix:c.Mat.shearAt2DMatrix,l=i(r[0]),d=i(r[1]);for(let r,u=0,i=a.length;u<i;u++)r=void 0==o?a[u]:a[u].$take(o),r.to(c.Mat.transform2D(r,s(l,d,n)));return p}static reflect2D(e,t,n){let o=Array.isArray(e)?e:[e];for(let a,r=0,i=o.length;r<i;r++)a=void 0==n?o[r]:o[r].$take(n),a.to(c.Mat.transform2D(a,c.Mat.reflectAt2DMatrix(t[0],t[1])));return p}static cosTable(){let e=new Float64Array(360);for(let t=0;360>t;t++)e[t]=s(t*n/180);return{table:e,cos:(t)=>e[o(p.boundAngle(p.toDegree(t)))]}}static sinTable(){let e=new Float64Array(360);for(let t=0;360>t;t++)e[t]=a(t*n/180);return{table:e,sin:(t)=>e[o(p.boundAngle(p.toDegree(t)))]}}}t.Geom=p;class h{static slope(e,t){return 0==t[0]-e[0]?void 0:(t[1]-e[1])/(t[0]-e[0])}static intercept(e,t){if(0==t[0]-e[0])return;let i=(t[1]-e[1])/(t[0]-e[0]),n=e[1]-i*e[0];return{slope:i,yi:n,xi:0==i?void 0:-n/i}}static collinear(e,t,i){let n=new u.Pt(0,0,0).to(t).$subtract(e),o=new u.Pt(0,0,0).to(e).$subtract(i);return n.$cross(o).equals(new u.Pt(0,0,0))}static perpendicularFromPt(e,t,i=!1){let n=e[0].$subtract(e[1]),o=e[1].$subtract(t),a=o.$subtract(n.$project(o));return i?a:a.$add(t)}static distanceFromPt(e,t,i=!1){return h.perpendicularFromPt(e,t,!0).magnitude()}static intersectRay2D(e,t){let i=h.intercept(e[0],e[1]),n=h.intercept(t[0],t[1]),o=e[0],a=t[0];if(i==void 0){if(n==void 0)return;let e=-n.slope*(a[0]-o[0])+a[1];return new u.Pt(o[0],e)}if(void 0==n){let e=-i.slope*(o[0]-a[0])+o[1];return new u.Pt(a[0],e)}if(n.slope!=i.slope){let e=(i.slope*o[0]-n.slope*a[0]+a[1]-o[1])/(i.slope-n.slope),t=i.slope*(e-o[0])+o[1];return new u.Pt(e,t)}return i.yi==n.yi?new u.Pt(o[0],o[1]):void 0}static intersectLine2D(e,t){let i=h.intersectRay2D(e,t);return i&&p.withinBound(i,e[0],e[1])&&p.withinBound(i,t[0],t[1])?i:void 0}static intersectLineWithRay2D(e,t){let i=h.intersectRay2D(e,t);return i&&p.withinBound(i,e[0],e[1])?i:void 0}static intersectPolygon2D(e,t,i=!1){let n=i?h.intersectLineWithRay2D:h.intersectLine2D,o=new u.Group;for(let a,r=0,s=t.length;r<s;r++)a=n(t[r],e),a&&o.push(a);return 0<o.length?o:void 0}static intersectGridWithRay2D(e,i){let n=h.intercept(new u.Pt(e[0]).subtract(i),new u.Pt(e[1]).subtract(i)),t=new u.Group;return n&&n.xi&&t.push(new u.Pt(i[0]+n.xi,i[1])),n&&n.yi&&t.push(new u.Pt(i[0],i[1]+n.yi)),t}static intersectGridWithLine2D(e,t){let n=h.intersectGridWithRay2D(e,t),o=new u.Group;for(let a=0,i=n.length;a<i;a++)p.withinBound(n[a],e[0],e[1])&&o.push(n[a]);return o}static subpoints(e,t){let n=new u.Group;for(let o=1;o<=t;o++)n.push(p.interpolate(e[0],e[1],o/(t+1)));return n}}t.Line=h;class g{static fromTopLeft(e,t,i,n=0){return new u.Group(new u.Pt(e),new u.Pt(e).add(t,i))}static fromCenter(e,t,i,n=0){let o=[t/2,i/2];return new u.Group(new u.Pt(e).subtract(o),new u.Pt(e).add(o))}static corners(e){let t=e[0].$min(e[1]),i=e[0].$max(e[1]);return new u.Group(t,new u.Pt(t.x,i.y),i,new u.Pt(i.x,t.y))}static sides(e){let[t,i,n,o]=g.corners(e);return[new u.Group(t,i),new u.Group(i,n),new u.Group(n,o),new u.Group(o,t)]}static polygon(e){let t=g.corners(e);return t.push(t[0].clone()),t}static quadrants(e){let t=g.corners(e),i=p.interpolate(e[0],e[1],0.5);return t.map((e)=>new u.Group(e,i.clone()))}static inside(e,t){return p.withinBound(t,e[0],e[1])}static intersect2D(e,t){return m.intersect2D(g.sides(e),t)}}t.Rectangle=g;class m{static intersect2D(e,t,n=!1){let o=[];for(let a,r=0,i=t.length;r<i;r++)a=h.intersectPolygon2D(t[r],e,n),a&&o.push(a);return o}static network(e,t=0){let n=[];for(let o=0,i=e.length;o<i;o++)o!=t&&n.push(new u.Group(e[t],e[o]));return n}}t.Polygon=m},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const n=i(6),o=i(1);class a extends n.Form{constructor(e){super(),this._style={fillStyle:'#e51c23',strokeStyle:'#fff',lineWidth:1,lineJoin:'miter',lineCap:'butt'},this._space=e,this._ctx=this._space.ctx,this._ctx.fillStyle=this._style.fillStyle,this._ctx.strokeStyle=this._style.strokeStyle}get space(){return this._space}fill(e){return'boolean'==typeof e?this.filled=e:(this.filled=!0,this._style.fillStyle=e,this._ctx.fillStyle=e),this}stroke(e,t,i,n){return'boolean'==typeof e?this.stroked=e:(this.stroked=!0,this._style.strokeStyle=e,this._ctx.strokeStyle=e,t&&(this._ctx.lineWidth=t,this._style.lineWidth=t),i&&(this._ctx.lineJoin=i,this._style.lineJoin=i),n&&(this._ctx.lineCap=n,this._style.lineCap=n)),this}reset(){for(let e in this._style)this._ctx[e]=this._style[e];return this}_paint(){this._filled&&this._ctx.fill(),this._stroked&&this._ctx.stroke()}point(e,t=5,i='square'){if(!a[i])throw`${i} is not a static function of CanvasForm`;return a[i](this._ctx,e,t),this._paint(),this}points(e,t=5,n='square'){for(let o=0,i=e.length;o<i;o++)this.point(e[o],t,n);return this}static circle(e,t,i){t&&(e.beginPath(),e.arc(t[0],t[1],i,0,o.Const.two_pi,!1),e.closePath())}circle(e,t){return a.circle(this._ctx,e,t),this}static arc(e,t,i,n,o,a){e.beginPath(),e.arc(t[0],t[1],i,n,o,a)}arc(e,t,i,n,o){return a.arc(this._ctx,e,t,i,n,o),this._paint(),this}static square(e,t,i){if(t){let n=t[0]-i,o=t[1]-i,a=t[0]+i,r=t[1]+i;e.beginPath(),e.moveTo(n,o),e.lineTo(n,r),e.lineTo(a,r),e.lineTo(a,o),e.closePath()}}line(e){return a.line(this._ctx,e),this._ctx.stroke(),this}lines(e){return this.line(o.Util.flatten(e)),this}static line(e,t){if(!(2>t.length)){e.beginPath(),e.moveTo(t[0][0],t[0][1]);for(let n=1,i=t.length;n<i;n++)t[n]&&e.lineTo(t[n][0],t[n][1])}}static rect(e,t){2>t.length||(e.beginPath(),e.moveTo(t[0][0],t[0][1]),e.lineTo(t[0][0],t[1][1]),e.lineTo(t[1][0],t[1][1]),e.lineTo(t[1][0],t[0][1]),e.closePath())}rect(e){return a.rect(this._ctx,e),this._paint(),this}static text(e,t,i,n){t&&e.fillText(i,t[0],t[1],n)}text(e,t,i){return a.text(this._ctx,e,t,i),this}log(e){this._ctx.font='12px sans-serif';let t=this._ctx.measureText(e).width+20;return this.stroke(!1).fill('rgba(0,0,0,.4)').rect([[0,0],[t,20]]),this.fill('#fff').text([10,14],e),this}draw(){return this}}t.CanvasForm=a},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});class i{constructor(e=11,t='sans-serif',i=''){this.size=e,this.face=t,this.style=i}get data(){return`${this.style} ${this.size}px ${this.face}`}}t.Font=i;class n{constructor(){this._filled=!0,this._stroked=!0}get filled(){return this._filled}set filled(e){this._filled=e}get stroked(){return this._stroked}set stroked(e){this._stroked=e}get font(){return this._font}set font(e){this._font=e}}t.Form=n},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const n=i(2);class o{constructor(){this.id='space',this.bound=new n.Bound,this._time={prev:0,diff:0,end:-1},this.players={},this.playerCount=0,this._animID=-1,this._pause=!1,this._refresh=void 0}refresh(e){return this._refresh=e,this}add(e){let t='function'==typeof e?{animate:e}:e,i=this.playerCount++,n=this.id+i;return this.players[n]=t,t.animateID=n,t.resize&&this.bound.inited&&t.resize(this.bound),void 0===this._refresh&&(this._refresh=!0),this}remove(e){return delete this.players[e.animateID],this}removeAll(){return this.players={},this}play(e=0){if(this._animID=requestAnimationFrame((e)=>this.play(e)),this._pause)return this;this._time.diff=e-this._time.prev,this._time.prev=e;try{this.playItems(e)}catch(e){throw cancelAnimationFrame(this._animID),e}return this}playItems(e){for(let t in this._refresh&&this.clear(),this.players)this.players[t].animate(e,this._time.diff,this);0<=this._time.end&&e>this._time.end&&cancelAnimationFrame(this._animID)}pause(e=!1){return this._pause=!e||!this._pause,this}resume(){return this._pause=!1,this}stop(e=0){return this._time.end=e,this}playOnce(e=5e3){return this.play(),this.stop(e),this}get boundingBox(){return this.bound.clone()}get size(){return this.bound.size.clone()}get center(){return this.size.divide(2)}get width(){return this.bound.width}get height(){return this.bound.height}}t.Space=o},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const n=i(7),o=i(0),a=i(2),r=i(5);class s extends n.Space{constructor(e,t){super(),this._pixelScale=1,this._autoResize=!0,this._bgcolor='#e1e9f0',this._pressed=!1,this._dragged=!1,this._hasMouse=!1,this._hasTouch=!1,this._renderFunc=void 0,this._isReady=!1;var i=null,n=!1;this.id='pt';e instanceof Element?(i=e,this.id='pts_existing_space'):(i=document.querySelector(e),n=!0,this.id=e);i?'canvas'==i.nodeName.toLowerCase()?(this._canvas=i,this._container=i.parentElement,this._autoResize=!1):(this._container=i,this._canvas=this._createElement('canvas',this.id+'_canvas'),this._container.appendChild(this._canvas)):(this._container=this._createElement('div',this.id+'_container'),this._canvas=this._createElement('canvas',this.id),this._container.appendChild(this._canvas),document.body.appendChild(this._container),n=!1),setTimeout(this._ready.bind(this,t),50),this._ctx=this._canvas.getContext('2d')}_createElement(e='div',t){let i=document.createElement(e);return i.setAttribute('id',t),i}_ready(e){if(!this._container)throw`Cannot initiate #${this.id} element`;this._isReady=!0;let t=this._autoResize?this._container.getBoundingClientRect():this._canvas.getBoundingClientRect();for(let i in t&&this.resize(a.Bound.fromBoundingRect(t)),this.clear(this._bgcolor),this._canvas.dispatchEvent(new Event('ready')),this.players)this.players[i].start&&this.players[i].start(this.bound.clone(),this);e&&e(this.bound,this._canvas)}setup(e){if(e.bgcolor&&(this._bgcolor=e.bgcolor),void 0!=e.resize&&this.autoResize(e.resize),!1!==e.retina){let e=window.devicePixelRatio||1,t=this._ctx.webkitBackingStorePixelRatio||this._ctx.mozBackingStorePixelRatio||this._ctx.msBackingStorePixelRatio||this._ctx.oBackingStorePixelRatio||this._ctx.backingStorePixelRatio||1;this._pixelScale=e/t}return this}get ctx(){return this._ctx}getForm(){return new r.CanvasForm(this)}_resizeHandler(e){let t=this._autoResize?this._container.getBoundingClientRect():this._canvas.getBoundingClientRect();t&&this.resize(a.Bound.fromBoundingRect(t),e)}autoResize(e=!0){return this._autoResize=e,e?window.addEventListener('resize',this._resizeHandler.bind(this)):window.removeEventListener('resize',this._resizeHandler.bind(this)),this}get element(){return this._canvas}get parent(){return this._container}resize(e,t){for(let i in this.bound=e,this._canvas.width=this.bound.size.x*this._pixelScale,this._canvas.height=this.bound.size.y*this._pixelScale,this._canvas.style.width=this.bound.size.x+'px',this._canvas.style.height=this.bound.size.y+'px',1!=this._pixelScale&&(this._ctx.scale(this._pixelScale,this._pixelScale),this._ctx.translate(0.5,0.5)),this.players){let e=this.players[i];e.resize&&e.resize(this.bound,t)}return this.render(this._ctx),this}clear(e){e&&(this._bgcolor=e);let t=this._ctx.fillStyle;return this._bgcolor&&'transparent'!=this._bgcolor?(this._ctx.fillStyle=this._bgcolor,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height)):this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._ctx.fillStyle=t,this}playItems(e){this._isReady&&(this._ctx.save(),super.playItems(e),this._ctx.restore(),this.render(this._ctx))}bindCanvas(e,t){this._canvas.addEventListener(e,t)}unbindCanvas(e,t){this._canvas.removeEventListener(e,t)}bindMouse(e=!0){e?(this.bindCanvas('mousedown',this._mouseDown.bind(this)),this.bindCanvas('mouseup',this._mouseUp.bind(this)),this.bindCanvas('mouseover',this._mouseOver.bind(this)),this.bindCanvas('mouseout',this._mouseOut.bind(this)),this.bindCanvas('mousemove',this._mouseMove.bind(this)),this._hasMouse=!0):(this.unbindCanvas('mousedown',this._mouseDown.bind(this)),this.unbindCanvas('mouseup',this._mouseUp.bind(this)),this.unbindCanvas('mouseover',this._mouseOver.bind(this)),this.unbindCanvas('mouseout',this._mouseOut.bind(this)),this.unbindCanvas('mousemove',this._mouseMove.bind(this)),this._hasMouse=!1)}bindTouch(e=!0){e?(this.bindCanvas('touchstart',this._mouseDown.bind(this)),this.bindCanvas('touchend',this._mouseUp.bind(this)),this.bindCanvas('touchmove',this._touchMove.bind(this)),this.bindCanvas('touchcancel',this._mouseOut.bind(this)),this._hasTouch=!0):(this.unbindCanvas('touchstart',this._mouseDown.bind(this)),this.unbindCanvas('touchend',this._mouseUp.bind(this)),this.unbindCanvas('touchmove',this._touchMove.bind(this)),this.unbindCanvas('touchcancel',this._mouseOut.bind(this)),this._hasTouch=!1)}touchesToPoints(e,n='touches'){if(!e||!e[n])return[];let a=[];for(var r=0;r<e[n].length;r++){let i=e[n].item(r);a.push(new o.Pt(i.pageX-this.bound.topLeft.x,i.pageY-this.bound.topLeft.y))}return a}_mouseAction(e,t){if(t instanceof TouchEvent)for(let i in this.players){let n=this.players[i],o=t.changedTouches&&0<t.changedTouches.length,a=o?t.changedTouches.item(0).pageX:0,r=o?t.changedTouches.item(0).pageY:0;n.action(e,a,r,t)}else for(let i in this.players){let n=this.players[i],o=t.offsetX||t.layerX,a=t.offsetY||t.layerY;n.action(e,o,a,t)}}_mouseDown(e){this._mouseAction('down',e),this._pressed=!0}_mouseUp(e){this._mouseAction('up',e),this._dragged&&this._mouseAction('drop',e),this._pressed=!1,this._dragged=!1}_mouseMove(e){this._mouseAction('move',e),this._pressed&&(this._dragged=!0,this._mouseAction('drag',e))}_mouseOver(e){this._mouseAction('over',e)}_mouseOut(e){this._mouseAction('out',e),this._dragged&&this._mouseAction('drop',e),this._dragged=!1}_touchMove(e){e.preventDefault(),this._mouseMove(e)}render(e){return this._renderFunc&&this._renderFunc(e,this),this}set customRendering(e){this._renderFunc=e}get customRendering(){return this._renderFunc}}t.CanvasSpace=s},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const n=i(0);t.Create=class{static distributeRandom(e,t,o=2){let a=[];for(let r,s=0;s<t;s++)r=[e.x+Math.random()*e.width],1<o&&r.push(e.y+Math.random()*e.height),2<o&&r.push(e.z+Math.random()*e.depth),a.push(new n.Pt(r));return a}}},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const o=n(0),a=n(1),r=n(2),s=n(9),l=n(8);window.Pt=o.Pt,console.log(new o.Pt(32,43).unit().magnitude()),console.log(a.Util.split([1,2,3,4,5,6,7,8,9,10,11,12,13],5));let d=[];for(let a,r=0;500>r;r++)a=new o.Pt(200*Math.random(),200*Math.random()),d.push(a);var c=new l.CanvasSpace('#pt',function(){i=s.Create.distributeRandom(new r.Bound(c.size),50)}).setup({retina:!0}),u=c.getForm(),_=c.getForm(),p=new o.Pt(50,50),g=p.op((e,t)=>e.$add(t)),h=[g(10,10),g(20,25)],m={a:g(10,10),b:g(20,25)};for(var b in m)console.log('==>',m[b].toString());console.log(h.reduce((e,t)=>e+' | '+t.toString(),'')),console.log(p.toString());var i=[];let y={size:(e)=>{let t=e.$subtract(c.size.$divide(2)).magnitude();return new o.Pt(t/8,t/(Math.max(c.width,c.height)/2))}};c.add({animate:(e,t)=>{u.fill('#999').text(new o.Pt(20,20),1e3/t+' fps'),u.reset(),u.stroke(!1),i.forEach((e)=>{let t=e.op(y);u.fill(`rgba(255,0,0,${1.2-t.size.y}`),u.point(e,t.size.x,'circle')})},action:(e,t,n)=>{if('move'==e){let e=c.boundingBox.center.$subtract(t,n),o=c.boundingBox.center.$subtract(e),a=new r.Bound(o,o.$add(e.$abs().multiply(2)));i=s.Create.distributeRandom(a,200)}}}),c.bindMouse(),c.playOnce(3e3)}]);
//# sourceMappingURL=testapp.min.js.map