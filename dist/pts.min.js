function _extendableBuiltin(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}var Pts=function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(n,'a',n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=11)}([function(e,t,n){'use strict';var o=Math.max,a=Math.min;Object.defineProperty(t,'__esModule',{value:!0});const i=n(1),s=n(4),r=n(3);t.PtBaseArray=Float32Array;class l extends t.PtBaseArray{constructor(...e){super(0<e.length?i.Util.getArgs(e):[0,0])}static make(e,n=0){let i=new t.PtBaseArray(e);return n&&i.fill(n),new l(i)}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(e){this[0]=e}set y(e){this[1]=e}set z(e){this[2]=e}set w(e){this[3]=e}clone(){return new l(this)}equals(e,t=1e-6){for(let n=0,i=this.length;n<i;n++)if(Math.abs(this[n]-e[n])>t)return!1;return!0}to(...e){let t=i.Util.getArgs(e);for(let n=0,i=a(this.length,t.length);n<i;n++)this[n]=t[n];return this}toAngle(e,t){let n=t==void 0?this.magnitude():t;return this.to(Math.cos(e)*n,Math.sin(e)*n)}op(e){let t=this;return(...n)=>{return e(t,...n)}}ops(e){let t=[];for(let n=0,i=e.length;n<i;n++)t.push(this.op(e[n]));return t}$map(e){let t=this.clone();return r.Vec.map(t,e),t}$take(e){let t=[];for(let n=0,i=e.length;n<i;n++)t.push(this[e[n]]||0);return new l(t)}$slice(e,n){let i=new t.PtBaseArray(this).slice(e,n);return new l(i)}$concat(...e){return new l(this.toArray().concat(i.Util.getArgs(e)))}add(...e){return 1===e.length&&'number'==typeof e[0]?r.Vec.add(this,e[0]):r.Vec.add(this,i.Util.getArgs(e)),this}$add(...e){return this.clone().add(...e)}subtract(...e){return 1===e.length&&'number'==typeof e[0]?r.Vec.subtract(this,e[0]):r.Vec.subtract(this,i.Util.getArgs(e)),this}$subtract(...e){return this.clone().subtract(...e)}multiply(...e){return 1===e.length&&'number'==typeof e[0]?r.Vec.multiply(this,e[0]):r.Vec.multiply(this,i.Util.getArgs(e)),this}$multiply(...e){return this.clone().multiply(...e)}divide(...e){return 1===e.length&&'number'==typeof e[0]?r.Vec.divide(this,e[0]):r.Vec.divide(this,i.Util.getArgs(e)),this}$divide(...e){return this.clone().divide(...e)}magnitudeSq(){return r.Vec.dot(this,this)}magnitude(){return r.Vec.magnitude(this)}unit(e=void 0){return r.Vec.unit(this,e),this}$unit(e=void 0){return this.clone().unit(e)}dot(...e){return r.Vec.dot(this,i.Util.getArgs(e))}$cross(...e){return r.Vec.cross(this,i.Util.getArgs(e))}$project(e){let t=e.magnitude(),n=this.$unit(),i=e.$divide(t),o=n.dot(i);return n.multiply(t*o)}abs(){return r.Vec.abs(this),this}$abs(){return this.clone().abs()}floor(){return r.Vec.floor(this),this}$floor(){return this.clone().floor()}ceil(){return r.Vec.ceil(this),this}$ceil(){return this.clone().ceil()}round(){return r.Vec.round(this),this}$round(){return this.clone().round()}$min(e){let t=this.clone();for(let n=0,i=a(this.length,e.length);n<i;n++)t[n]=a(this[n],e[n]);return t}$max(e){let t=this.clone();for(let n=0,i=a(this.length,e.length);n<i;n++)t[n]=o(this[n],e[n]);return t}angle(e=i.Const.xy){return Math.atan2(this[e[1]],this[e[0]])}angleBetween(e,t=i.Const.xy){return s.Geom.boundRadian(this.angle(t))-s.Geom.boundRadian(e.angle(t))}scale(e,t){return s.Geom.scale(this,e,t||l.make(this.length,0)),this}rotate2D(e,t,n){return s.Geom.rotate2D(this,e,t||l.make(this.length,0),n),this}shear2D(e,t,n){return s.Geom.shear2D(this,e,t||l.make(this.length,0),n),this}reflect2D(e,t){return s.Geom.reflect2D(this,e,t),this}isPerpendicular(e){return 0==this.dot(e)}toString(){return`Pt(${this.join(',')})`}toArray(){return[].slice.call(this)}static combine(e,t,n){let o=new d;for(let a=0,i=e.length;a<i;a++)for(let i=0,s=t.length;i<s;i++)o.push(n(e[a],t[i]));return o}}t.Pt=l;class d extends _extendableBuiltin(Array){constructor(...e){super(...e)}clone(){let e=new d;for(let t=0,n=this.length;t<n;t++)e.push(this[t].clone());return e}static fromArray(e){let t=new d;for(let n,o=0,i=e.length;o<i;o++)n=e[o]instanceof l?e[o]:new l(e[o]),t.push(n);return t}static fromGroup(e){return d.from(e)}split(e,t){let n=i.Util.split(this,e,t);return n.map((e)=>d.fromGroup(e))}insert(e,t=0){d.prototype.splice.apply(this,[t,0,...e]);return this}remove(e=0,t=1){let n=0>e?[-1*e-1,t]:[e,t];return d.prototype.splice.apply(this,n)}segments(e=2,t=2){return this.split(2,t)}lines(){return this.segments(2,1)}op(e){let t=this;return(...n)=>{return e(t,...n)}}ops(e){let t=[];for(let n=0,i=e.length;n<i;n++)t.push(this.op(e[n]));return t}boundingBox(){return s.Geom.boundingBox(this)}centroid(){return s.Geom.centroid(this)}interpolate(e){let t=this.length-1,n=1/(this.length-1),i=Math.floor(e/n);return s.Geom.interpolate(this[i],this[i+1],(e-i*n)*t)}moveBy(...e){let t=i.Util.getArgs(e);for(let n=0,i=this.length;n<i;n++)this[n].add(t);return this}moveTo(...e){let t=new l(i.Util.getArgs(e)).subtract(this[0]);return this.moveBy(t),this}scale(e,t){for(let n=0,i=this.length;n<i;n++)s.Geom.scale(this[n],e,t||this[0]);return this}rotate2D(e,t,n){for(let o=0,i=this.length;o<i;o++)s.Geom.rotate2D(this[o],e,t||this[0],n);return this}shear2D(e,t,n){for(let o=0,i=this.length;o<i;o++)s.Geom.shear2D(this[o],e,t||this[0],n);return this}reflect2D(e,t){for(let n=0,i=this.length;n<i;n++)s.Geom.reflect2D(this[n],e,t);return this}sortByDimension(e,t=!1){return this.sort((n,i)=>t?i[e]-n[e]:n[e]-i[e])}toString(){return'Group[ '+this.reduce((e,t)=>e+t.toString()+' ','')+' ]'}zipOne(e,t=!1){let n='boolean'==typeof t?'get':'at',o=[];for(let n=0,i=this.length;n<i;n++){if(this[n].length-1<e&&!1===t)throw`Index ${e} is out of bounds`;o.push(this[n][e]||t)}return new l(o)}zip(e=!1,t=!1){let n=new d,a=t?this.reduce((e,t)=>o(e,t.length),0):this[0].length;for(let o=0;o<a;o++)n.push(this.zipOne(o,e));return n}static combine(e,t,n){let o=[];for(let a=0,i=e.length;a<i;a++)for(let i=0,s=t.length;i<s;i++)o.push(n(e[a],t[i]));return o}}t.Group=d},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const i=n(0);t.Const={xy:'xy',yz:'yz',xz:'xz',xyz:'xyz',horizontal:0,vertical:1,identical:0,right:4,bottom_right:5,bottom:6,bottom_left:7,left:8,top_left:1,top:2,top_right:3,epsilon:1e-4,pi:Math.PI,two_pi:6.283185307179586,half_pi:1.5707963267948966,quarter_pi:0.7853981633974483,one_degree:0.017453292519943295,rad_to_deg:57.29577951308232,deg_to_rad:0.017453292519943295,gravity:9.81,newton:0.10197,gaussian:0.3989422804014327};t.Util=class{static getArgs(e){if(1>e.length)return[];var t=[],n=Array.isArray(e[0])||ArrayBuffer.isView(e[0]);if('number'==typeof e[0])t=Array.prototype.slice.call(e);else if('object'==typeof e[0]&&!n){let n=['x','y','z','w'],o=e[0];for(let e=0;e<n.length&&!(o.length&&e>=o.length||!(n[e]in o));e++)t.push(o[n[e]])}else n&&(t=[].slice.call(e[0]));return t}static split(e,t,n){let o=n||t,a=[];for(let s=0;s<e.length&&!(s*o+t>e.length);s++)a.push(e.slice(s*o,s*o+t));return a}static flatten(e,t=!0){let n=t?new i.Group:[];return n.concat.apply(n,e)}static equals(e,t,n=1e-5){return Math.abs(e-t)<n}}},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const i=n(0);class o{constructor(e,t){if(this._center=new i.Pt,this._size=new i.Pt,this._topLeft=new i.Pt,this._bottomRight=new i.Pt,this._inited=!1,e&&(this._size=new i.Pt(e),this._inited=!0),e&&t){let n=new i.Pt(e),o=new i.Pt(t);this._topLeft=n.$min(o),this._bottomRight=n.$max(o),this._updateSize()}}clone(){return new o(this._topLeft,this._bottomRight)}_updateSize(){this._size=this._bottomRight.$subtract(this._topLeft).abs(),this._updateCenter()}_updateCenter(){this._center=this._size.$multiply(0.5).add(this._topLeft)}_updatePosFromTop(){this._bottomRight=this._topLeft.$add(this._size),this._updateCenter()}_updatePosFromBottom(){this._topLeft=this._bottomRight.$subtract(this._size),this._updateCenter()}_updatePosFromCenter(){let e=this._size.$multiply(0.5);this._topLeft=this._center.$subtract(e),this._bottomRight=this._center.$add(e)}get size(){return new i.Pt(this._size)}set size(e){this._size=new i.Pt(e),this._updatePosFromTop()}get center(){return new i.Pt(this._center)}set center(e){this._center=new i.Pt(e),this._updatePosFromCenter()}get topLeft(){return new i.Pt(this._topLeft)}set topLeft(e){this._topLeft=new i.Pt(e),this._updateSize()}get bottomRight(){return new i.Pt(this._bottomRight)}set bottomRight(e){this._bottomRight=new i.Pt(e),this._updateSize()}get width(){return 0<this._size.length?this._size.x:0}set width(e){this._size.x=e,this._updatePosFromTop()}get height(){return 1<this._size.length?this._size.y:0}set height(e){this._size.y=e,this._updatePosFromTop()}get depth(){return 2<this._size.length?this._size.z:0}set depth(e){this._size.z=e,this._updatePosFromTop()}get x(){return this.topLeft.x}get y(){return this.topLeft.y}get z(){return this.topLeft.z}get inited(){return this._inited}static fromBoundingRect(e){let t=new o(new i.Pt(e.left||0,e.top||0),new i.Pt(e.right||0,e.bottom||0));return e.width&&e.height&&(t.size=new i.Pt(e.width,e.height)),t}}t.Bound=o},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const i=n(0),o=n(4);class s{static add(e,t){if('number'==typeof t)for(let n=0,i=e.length;n<i;n++)e[n]+=t;else for(let n=0,i=e.length;n<i;n++)e[n]+=t[n]||0;return e}static subtract(e,t){if('number'==typeof t)for(let n=0,i=e.length;n<i;n++)e[n]-=t;else for(let n=0,i=e.length;n<i;n++)e[n]-=t[n]||0;return e}static multiply(e,t){if('number'==typeof t)for(let n=0,i=e.length;n<i;n++)e[n]*=t;else for(let n=0,i=e.length;n<i;n++)e[n]*=t[n]||1;return e}static divide(e,t){if('number'==typeof t)for(let n=0,i=e.length;n<i;n++)e[n]/=t;else for(let n=0,i=e.length;n<i;n++)e[n]/=t[n]||1;return e}static dot(e,t){if(e.length!=t.length)throw'Array lengths don\'t match';let n=0;for(let o=0,i=e.length;o<i;o++)n+=e[o]*t[o];return n}static cross(e,t){return new i.Pt(e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0])}static magnitude(e){return Math.sqrt(s.dot(e,e))}static unit(e,t=void 0){let n=t===void 0?s.magnitude(e):t;return s.divide(e,n)}static abs(e){return s.map(e,Math.abs)}static floor(e){return s.map(e,Math.floor)}static ceil(e){return s.map(e,Math.ceil)}static round(e){return s.map(e,Math.round)}static max(e){let t=Number.MIN_VALUE,n=0;for(let o=0,i=e.length;o<i;o++)t=Math.max(t,e[o]),t===e[o]&&(n=o);return{value:t,index:n}}static min(e){let t=Number.MAX_VALUE,n=0;for(let o=0,i=e.length;o<i;o++)t=Math.min(t,e[o]),t===e[o]&&(n=o);return{value:t,index:n}}static sum(e){let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n];return t}static map(e,t){for(let n=0,i=e.length;n<i;n++)e[n]=t(e[n],n,e);return e}}t.Vec=s;class a{static transform2D(e,t){let n=e[0]*t[0][0]+e[1]*t[1][0]+t[2][0],o=e[0]*t[0][1]+e[1]*t[1][1]+t[2][1];return new i.Pt(n,o)}static scale2DMatrix(e,t){return new i.Group(new i.Pt(e,0,0),new i.Pt(0,t,0),new i.Pt(0,0,1))}static rotate2DMatrix(e,t){return new i.Group(new i.Pt(e,t,0),new i.Pt(-t,e,0),new i.Pt(0,0,1))}static shear2DMatrix(e,t){return new i.Group(new i.Pt(1,e,0),new i.Pt(t,1,0),new i.Pt(0,0,1))}static translate2DMatrix(e,t){return new i.Group(new i.Pt(1,0,0),new i.Pt(0,1,0),new i.Pt(e,t,1))}static scaleAt2DMatrix(e,t,n){let i=a.scale2DMatrix(e,t);return i[2][0]=-n[0]*e+n[0],i[2][1]=-n[1]*t+n[1],i}static rotateAt2DMatrix(e,t,n){let i=a.rotate2DMatrix(e,t);return i[2][0]=n[0]*(1-e)+n[1]*t,i[2][1]=n[1]*(1-e)-n[0]*t,i}static shearAt2DMatrix(e,t,n){let i=a.shear2DMatrix(e,t);return i[2][0]=-n[1]*t,i[2][1]=-n[0]*e,i}static reflectAt2DMatrix(e,t){let n=o.Line.intercept(e,t);if(n==void 0)return[new i.Pt([-1,0,0]),new i.Pt([0,1,0]),new i.Pt([e[0]+t[0],0,1])];let a=n.yi,s=2*Math.atan(n.slope),r=Math.cos(s),l=Math.sin(s);return[new i.Pt([r,l,0]),new i.Pt([l,-r,0]),new i.Pt([-a*l,a+a*r,1])]}}t.Mat=a},function(e,t,n){'use strict';var o=Math.PI,i=Math.floor,s=Math.max,a=Math.sin,r=Math.cos,l=Math.min;Object.defineProperty(t,'__esModule',{value:!0});const d=n(1),_=n(0),c=n(3);class u{static lerp(e,n,i){return(1-i)*e+i*n}static boundValue(e,t,n,i=!1){let o=Math.abs(n-t),s=e%o;return s>n?s-=o:s<t&&(s+=o),s}static within(e,t,n){return e>=l(t,n)&&e<=s(t,n)}static randomRange(e,t=0){let n=e>t?e-t:t-e;return e+Math.random()*n}static normalizeValue(e,t,n){let i=l(t,n),o=s(t,n);return(e-i)/(o-i)}static sum(e){let t=_.Pt.make(e[0].length,0);for(let n=0,i=e.length;n<i;n++)t.add(e[n]);return t}static average(e){return u.sum(e).divide(e.length)}static mapToRange(e,t,n,i,o){if(t==n)throw'[currMin, currMax] must define a range that is not zero';let a=l(i,o),r=s(i,o);return u.normalizeValue(e,t,n)*(r-a)+a}}t.Num=u;class p{static boundAngle(e){return u.boundValue(e,0,360)}static boundRadian(e){return u.boundValue(e,0,d.Const.two_pi)}static toRadian(e){return e*d.Const.deg_to_rad}static toDegree(e){return e*d.Const.rad_to_deg}static boundingBox(e){let t=_.Pt.make(e[0].length,Number.MAX_VALUE),n=_.Pt.make(e[0].length,Number.MIN_VALUE);for(let o=0,i=e.length;o<i;o++)for(let i=0,a=e[o].length;i<a;i++)e[o][i]<t[i]&&(t[i]=e[o][i]),e[o][i]>n[i]&&(n[i]=e[o][i]);return new _.Group(t,n)}static centroid(e){return u.average(e)}static interpolate(e,n,o=0.5){let t=l(e.length,n.length),a=_.Pt.make(t);for(let s=0;s<t;s++)a[s]=e[s]*(1-o)+n[s]*o;return a}static perpendicular(e,t=d.Const.xy){let n=t[1],i=t[0],o=new _.Pt(e),a=new _.Pt(o);a[i]=-o[n],a[n]=o[i];let s=new _.Pt(o);return s[i]=o[n],s[n]=-o[i],new _.Group(a,s)}static isPerpendicular(e,t){return 0===new _.Pt(e).dot(t)}static withinBound(e,t,n){for(let o=0,i=l(e.length,t.length,n.length);o<i;o++)if(!(e[o]>=l(t[o],n[o])&&e[o]<=s(t[o],n[o])))return!1;return!0}static scale(e,t,n){let o=Array.isArray(e)?e:[e],i='number'==typeof t?_.Pt.make(o[0].length,t):t;n||(n=_.Pt.make(o[0].length,0));for(let a,s=0,r=o.length;s<r;s++){a=o[s];for(let e=0,t=a.length;e<t;e++)a[e]=n&&n[e]?n[e]+(a[e]-n[e])*i[e]:a[e]*i[e]}return p}static rotate2D(e,t,n,o){let s=Array.isArray(e)?e:[e],l=n?c.Mat.rotateAt2DMatrix:c.Mat.rotate2DMatrix;n||(n=_.Pt.make(s[0].length,0));let d=r(t),u=a(t);for(let a,r=0,i=s.length;r<i;r++)a=o?s[r].$take(o):s[r],a.to(c.Mat.transform2D(a,l(d,u,n)));return p}static shear2D(e,t,n,o){var i=Math.tan;let a=Array.isArray(e)?e:[e],r='number'==typeof t?[t,t]:t;n||(n=_.Pt.make(a[0].length,0));let s=n?c.Mat.shearAt2DMatrix:c.Mat.shear2DMatrix,l=i(r[0]),d=i(r[1]);for(let r,_=0,i=a.length;_<i;_++)r=o?a[_].$take(o):a[_],r.to(c.Mat.transform2D(r,s(l,d,n)));return p}static reflect2D(e,t,n){let o=Array.isArray(e)?e:[e];for(let a,s=0,i=o.length;s<i;s++)a=n?o[s].$take(n):o[s],a.to(c.Mat.transform2D(a,c.Mat.reflectAt2DMatrix(t[0],t[1])));return p}static cosTable(){let e=new Float64Array(360);for(let t=0;360>t;t++)e[t]=r(t*o/180);return{table:e,cos:(t)=>e[i(p.boundAngle(p.toDegree(t)))]}}static sinTable(){let e=new Float64Array(360);for(let t=0;360>t;t++)e[t]=a(t*o/180);return{table:e,sin:(t)=>e[i(p.boundAngle(p.toDegree(t)))]}}}t.Geom=p;class h{static slope(e,t){return 0==t[0]-e[0]?void 0:(t[1]-e[1])/(t[0]-e[0])}static intercept(e,t){if(0==t[0]-e[0])return;let n=(t[1]-e[1])/(t[0]-e[0]),i=e[1]-n*e[0];return{slope:n,yi:i,xi:0==n?void 0:-i/n}}static collinear(e,t,n){let i=new _.Pt(0,0,0).to(t).$subtract(e),o=new _.Pt(0,0,0).to(e).$subtract(n);return i.$cross(o).equals(new _.Pt(0,0,0))}static perpendicularFromPt(e,t,n=!1){let i=e[0].$subtract(e[1]),o=e[1].$subtract(t),a=o.$subtract(i.$project(o));return n?a:a.$add(t)}static distanceFromPt(e,t,n=!1){return h.perpendicularFromPt(e,t,!0).magnitude()}static intersectRay2D(e,t){let n=h.intercept(e[0],e[1]),i=h.intercept(t[0],t[1]),o=e[0],a=t[0];if(n==void 0){if(i==void 0)return;let e=-i.slope*(a[0]-o[0])+a[1];return new _.Pt(o[0],e)}if(void 0==i){let e=-n.slope*(o[0]-a[0])+o[1];return new _.Pt(a[0],e)}if(i.slope!=n.slope){let e=(n.slope*o[0]-i.slope*a[0]+a[1]-o[1])/(n.slope-i.slope),t=n.slope*(e-o[0])+o[1];return new _.Pt(e,t)}return n.yi==i.yi?new _.Pt(o[0],o[1]):void 0}static intersectLine2D(e,t){let n=h.intersectRay2D(e,t);return n&&p.withinBound(n,e[0],e[1])&&p.withinBound(n,t[0],t[1])?n:void 0}static intersectLineWithRay2D(e,t){let n=h.intersectRay2D(e,t);return n&&p.withinBound(n,e[0],e[1])?n:void 0}static intersectPolygon2D(e,t,n=!1){let o=n?h.intersectLineWithRay2D:h.intersectLine2D,a=new _.Group;for(let s,r=0,i=t.length;r<i;r++)s=o(t[r],e),s&&a.push(s);return 0<a.length?a:void 0}static intersectGridWithRay2D(e,n){let i=h.intercept(new _.Pt(e[0]).subtract(n),new _.Pt(e[1]).subtract(n)),t=new _.Group;return i&&i.xi&&t.push(new _.Pt(n[0]+i.xi,n[1])),i&&i.yi&&t.push(new _.Pt(n[0],n[1]+i.yi)),t}static intersectGridWithLine2D(e,t){let n=h.intersectGridWithRay2D(e,t),o=new _.Group;for(let a=0,i=n.length;a<i;a++)p.withinBound(n[a],e[0],e[1])&&o.push(n[a]);return o}static subpoints(e,t){let n=new _.Group;for(let o=1;o<=t;o++)n.push(p.interpolate(e[0],e[1],o/(t+1)));return n}}t.Line=h;class g{static fromTopLeft(e,t,n,i=0){return new _.Group(new _.Pt(e),new _.Pt(e).add(t,n))}static fromCenter(e,t,n,i=0){let o=[t/2,n/2];return new _.Group(new _.Pt(e).subtract(o),new _.Pt(e).add(o))}static corners(e){let t=e[0].$min(e[1]),n=e[0].$max(e[1]);return new _.Group(t,new _.Pt(t.x,n.y),n,new _.Pt(n.x,t.y))}static sides(e){let[t,n,i,o]=g.corners(e);return[new _.Group(t,n),new _.Group(n,i),new _.Group(i,o),new _.Group(o,t)]}static polygon(e){let t=g.corners(e);return t.push(t[0].clone()),t}static quadrants(e){let t=g.corners(e),n=p.interpolate(e[0],e[1],0.5);return t.map((e)=>new _.Group(e,n.clone()))}static inside(e,t){return p.withinBound(t,e[0],e[1])}static intersect2D(e,t){return m.intersect2D(g.sides(e),t)}}t.Rectangle=g;class m{static intersect2D(e,t,n=!1){let o=[];for(let a,s=0,i=t.length;s<i;s++)a=h.intersectPolygon2D(t[s],e,n),a&&o.push(a);return o}static network(e,t=0){let n=[];for(let o=0,i=e.length;o<i;o++)o!=t&&n.push(new _.Group(e[t],e[o]));return n}}t.Polygon=m},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const i=n(6),o=n(1);class a extends i.Form{constructor(e){super(),this._style={fillStyle:'#e51c23',strokeStyle:'#fff',lineWidth:1,lineJoin:'miter',lineCap:'butt'},this._space=e,this._ctx=this._space.ctx,this._ctx.fillStyle=this._style.fillStyle,this._ctx.strokeStyle=this._style.strokeStyle}get space(){return this._space}fill(e){return'boolean'==typeof e?this.filled=e:(this.filled=!0,this._style.fillStyle=e,this._ctx.fillStyle=e),this}stroke(e,t,n,i){return'boolean'==typeof e?this.stroked=e:(this.stroked=!0,this._style.strokeStyle=e,this._ctx.strokeStyle=e,t&&(this._ctx.lineWidth=t,this._style.lineWidth=t),n&&(this._ctx.lineJoin=n,this._style.lineJoin=n),i&&(this._ctx.lineCap=i,this._style.lineCap=i)),this}reset(){for(let e in this._style)this._ctx[e]=this._style[e];return this}_paint(){this._filled&&this._ctx.fill(),this._stroked&&this._ctx.stroke()}point(e,t=5,n='square'){if(!a[n])throw`${n} is not a static function of CanvasForm`;return a[n](this._ctx,e,t),this._paint(),this}points(e,t=5,n='square'){for(let o=0,i=e.length;o<i;o++)this.point(e[o],t,n);return this}static circle(e,t,n){t&&(e.beginPath(),e.arc(t[0],t[1],n,0,o.Const.two_pi,!1),e.closePath())}circle(e,t){return a.circle(this._ctx,e,t),this}static arc(e,t,n,i,o,a){e.beginPath(),e.arc(t[0],t[1],n,i,o,a)}arc(e,t,n,i,o){return a.arc(this._ctx,e,t,n,i,o),this._paint(),this}static square(e,t,n){if(t){let i=t[0]-n,o=t[1]-n,a=t[0]+n,s=t[1]+n;e.beginPath(),e.moveTo(i,o),e.lineTo(i,s),e.lineTo(a,s),e.lineTo(a,o),e.closePath()}}line(e){return a.line(this._ctx,e),this._ctx.stroke(),this}lines(e){return this.line(o.Util.flatten(e)),this}static line(e,t){if(!(2>t.length)){e.beginPath(),e.moveTo(t[0][0],t[0][1]);for(let n=1,i=t.length;n<i;n++)t[n]&&e.lineTo(t[n][0],t[n][1])}}static rect(e,t){2>t.length||(e.beginPath(),e.moveTo(t[0][0],t[0][1]),e.lineTo(t[0][0],t[1][1]),e.lineTo(t[1][0],t[1][1]),e.lineTo(t[1][0],t[0][1]),e.closePath())}rect(e){return a.rect(this._ctx,e),this._paint(),this}static text(e,t,n,i){t&&e.fillText(n,t[0],t[1],i)}text(e,t,n){return a.text(this._ctx,e,t,n),this}log(e){this._ctx.font='12px sans-serif';let t=this._ctx.measureText(e).width+20;return this.stroke(!1).fill('rgba(0,0,0,.4)').rect([[0,0],[t,20]]),this.fill('#fff').text([10,14],e),this}draw(){return this}}t.CanvasForm=a},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0});class n{constructor(e=11,t='sans-serif',n=''){this.size=e,this.face=t,this.style=n}get data(){return`${this.style} ${this.size}px ${this.face}`}}t.Font=n;class i{constructor(){this._filled=!0,this._stroked=!0}get filled(){return this._filled}set filled(e){this._filled=e}get stroked(){return this._stroked}set stroked(e){this._stroked=e}get font(){return this._font}set font(e){this._font=e}}t.Form=i},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const i=n(2);class o{constructor(){this.id='space',this.bound=new i.Bound,this._time={prev:0,diff:0,end:-1},this.players={},this.playerCount=0,this._animID=-1,this._pause=!1,this._refresh=void 0}refresh(e){return this._refresh=e,this}add(e){let t='function'==typeof e?{animate:e}:e,n=this.playerCount++,i=this.id+n;return this.players[i]=t,t.animateID=i,t.resize&&this.bound.inited&&t.resize(this.bound),void 0===this._refresh&&(this._refresh=!0),this}remove(e){return delete this.players[e.animateID],this}removeAll(){return this.players={},this}play(e=0){if(this._animID=requestAnimationFrame((e)=>this.play(e)),this._pause)return this;this._time.diff=e-this._time.prev,this._time.prev=e;try{this.playItems(e)}catch(e){throw cancelAnimationFrame(this._animID),e}return this}playItems(e){for(let t in this._refresh&&this.clear(),this.players)this.players[t].animate(e,this._time.diff,this);0<=this._time.end&&e>this._time.end&&cancelAnimationFrame(this._animID)}pause(e=!1){return this._pause=!e||!this._pause,this}resume(){return this._pause=!1,this}stop(e=0){return this._time.end=e,this}playOnce(e=5e3){return this.play(),this.stop(e),this}get boundingBox(){return this.bound.clone()}get size(){return this.bound.size.clone()}get center(){return this.size.divide(2)}get width(){return this.bound.width}get height(){return this.bound.height}}t.Space=o},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const i=n(7),o=n(0),a=n(2),s=n(5);class r extends i.Space{constructor(e,t){super(),this._pixelScale=1,this._autoResize=!0,this._bgcolor='#e1e9f0',this._pressed=!1,this._dragged=!1,this._hasMouse=!1,this._hasTouch=!1,this._renderFunc=void 0,this._isReady=!1;var n=null,i=!1;this.id='pt';e instanceof Element?(n=e,this.id='pts_existing_space'):(n=document.querySelector(e),i=!0,this.id=e);n?'canvas'==n.nodeName.toLowerCase()?(this._canvas=n,this._container=n.parentElement,this._autoResize=!1):(this._container=n,this._canvas=this._createElement('canvas',this.id+'_canvas'),this._container.appendChild(this._canvas)):(this._container=this._createElement('div',this.id+'_container'),this._canvas=this._createElement('canvas',this.id),this._container.appendChild(this._canvas),document.body.appendChild(this._container),i=!1),setTimeout(this._ready.bind(this,t),50),this._ctx=this._canvas.getContext('2d')}_createElement(e='div',t){let n=document.createElement(e);return n.setAttribute('id',t),n}_ready(e){if(!this._container)throw`Cannot initiate #${this.id} element`;this._isReady=!0;let t=this._autoResize?this._container.getBoundingClientRect():this._canvas.getBoundingClientRect();for(let n in t&&this.resize(a.Bound.fromBoundingRect(t)),this.clear(this._bgcolor),this._canvas.dispatchEvent(new Event('ready')),this.players)this.players[n].start&&this.players[n].start(this.bound.clone(),this);e&&e(this.bound,this._canvas)}setup(e){if(e.bgcolor&&(this._bgcolor=e.bgcolor),void 0!=e.resize&&this.autoResize(e.resize),!1!==e.retina){let e=window.devicePixelRatio||1,t=this._ctx.webkitBackingStorePixelRatio||this._ctx.mozBackingStorePixelRatio||this._ctx.msBackingStorePixelRatio||this._ctx.oBackingStorePixelRatio||this._ctx.backingStorePixelRatio||1;this._pixelScale=e/t}return this}get ctx(){return this._ctx}getForm(){return new s.CanvasForm(this)}_resizeHandler(e){let t=this._autoResize?this._container.getBoundingClientRect():this._canvas.getBoundingClientRect();t&&this.resize(a.Bound.fromBoundingRect(t),e)}autoResize(e=!0){return this._autoResize=e,e?window.addEventListener('resize',this._resizeHandler.bind(this)):window.removeEventListener('resize',this._resizeHandler.bind(this)),this}get element(){return this._canvas}get parent(){return this._container}resize(e,t){for(let n in this.bound=e,this._canvas.width=this.bound.size.x*this._pixelScale,this._canvas.height=this.bound.size.y*this._pixelScale,this._canvas.style.width=this.bound.size.x+'px',this._canvas.style.height=this.bound.size.y+'px',1!=this._pixelScale&&(this._ctx.scale(this._pixelScale,this._pixelScale),this._ctx.translate(0.5,0.5)),this.players){let e=this.players[n];e.resize&&e.resize(this.bound,t)}return this.render(this._ctx),this}clear(e){e&&(this._bgcolor=e);let t=this._ctx.fillStyle;return this._bgcolor&&'transparent'!=this._bgcolor?(this._ctx.fillStyle=this._bgcolor,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height)):this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._ctx.fillStyle=t,this}playItems(e){this._isReady&&(this._ctx.save(),super.playItems(e),this._ctx.restore(),this.render(this._ctx))}bindCanvas(e,t){this._canvas.addEventListener(e,t)}unbindCanvas(e,t){this._canvas.removeEventListener(e,t)}bindMouse(e=!0){e?(this.bindCanvas('mousedown',this._mouseDown.bind(this)),this.bindCanvas('mouseup',this._mouseUp.bind(this)),this.bindCanvas('mouseover',this._mouseOver.bind(this)),this.bindCanvas('mouseout',this._mouseOut.bind(this)),this.bindCanvas('mousemove',this._mouseMove.bind(this)),this._hasMouse=!0):(this.unbindCanvas('mousedown',this._mouseDown.bind(this)),this.unbindCanvas('mouseup',this._mouseUp.bind(this)),this.unbindCanvas('mouseover',this._mouseOver.bind(this)),this.unbindCanvas('mouseout',this._mouseOut.bind(this)),this.unbindCanvas('mousemove',this._mouseMove.bind(this)),this._hasMouse=!1)}bindTouch(e=!0){e?(this.bindCanvas('touchstart',this._mouseDown.bind(this)),this.bindCanvas('touchend',this._mouseUp.bind(this)),this.bindCanvas('touchmove',this._touchMove.bind(this)),this.bindCanvas('touchcancel',this._mouseOut.bind(this)),this._hasTouch=!0):(this.unbindCanvas('touchstart',this._mouseDown.bind(this)),this.unbindCanvas('touchend',this._mouseUp.bind(this)),this.unbindCanvas('touchmove',this._touchMove.bind(this)),this.unbindCanvas('touchcancel',this._mouseOut.bind(this)),this._hasTouch=!1)}touchesToPoints(e,n='touches'){if(!e||!e[n])return[];let a=[];for(var s=0;s<e[n].length;s++){let i=e[n].item(s);a.push(new o.Pt(i.pageX-this.bound.topLeft.x,i.pageY-this.bound.topLeft.y))}return a}_mouseAction(e,t){if(t instanceof TouchEvent)for(let n in this.players){let i=this.players[n],o=t.changedTouches&&0<t.changedTouches.length,a=o?t.changedTouches.item(0).pageX:0,s=o?t.changedTouches.item(0).pageY:0;i.action(e,a,s,t)}else for(let n in this.players){let i=this.players[n],o=t.offsetX||t.layerX,a=t.offsetY||t.layerY;i.action(e,o,a,t)}}_mouseDown(e){this._mouseAction('down',e),this._pressed=!0}_mouseUp(e){this._mouseAction('up',e),this._dragged&&this._mouseAction('drop',e),this._pressed=!1,this._dragged=!1}_mouseMove(e){this._mouseAction('move',e),this._pressed&&(this._dragged=!0,this._mouseAction('drag',e))}_mouseOver(e){this._mouseAction('over',e)}_mouseOut(e){this._mouseAction('out',e),this._dragged&&this._mouseAction('drop',e),this._dragged=!1}_touchMove(e){e.preventDefault(),this._mouseMove(e)}render(e){return this._renderFunc&&this._renderFunc(e,this),this}set customRendering(e){this._renderFunc=e}get customRendering(){return this._renderFunc}}t.CanvasSpace=r},function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const o=n(0);t.Create=class{static distributeRandom(e,t,n=2){let a=[];for(let s,r=0;r<t;r++)s=[e.x+Math.random()*e.width],1<n&&s.push(e.y+Math.random()*e.height),2<n&&s.push(e.z+Math.random()*e.depth),a.push(new o.Pt(s));return a}}},,function(e,t,n){'use strict';Object.defineProperty(t,'__esModule',{value:!0});const i=n(2),o=n(5),a=n(8),s=n(9),r=n(6),l=n(3),d=n(4),c=n(0),_=n(7),u=n(1);e.exports=Object.assign({namespace:(t)=>{let n=e.exports;for(let e in n)'namespace'!=e&&(t[e]=n[e])}},i,o,a,s,r,l,d,c,_,u)}]);
